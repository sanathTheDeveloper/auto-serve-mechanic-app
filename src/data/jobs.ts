import { Job, StatusConfig, Quote } from '@/types/booking';
import { format, addDays, subDays } from 'date-fns';

const today = new Date();
const formatDate = (date: Date) => format(date, 'yyyy-MM-dd');
const formatDateTime = (date: Date) => date.toISOString();

// Sample quotes for jobs
const sampleQuotes: { [key: string]: Quote } = {
  "quote-001": {
    id: "quote-001",
    items: [
      {
        id: "item-001",
        description: "Brake pad replacement (front)",
        type: "parts",
        quantity: 1,
        unitPrice: 120,
        totalPrice: 120
      },
      {
        id: "item-002",
        description: "Labor - brake service",
        type: "labor",
        quantity: 2,
        unitPrice: 95,
        totalPrice: 190
      }
    ],
    subtotal: 310,
    tax: 31,
    total: 341,
    validUntil: formatDate(addDays(today, 7)),
    status: "pending",
    notes: "Includes inspection of brake rotors",
    createdAt: formatDateTime(subDays(today, 1)),
  },
  "quote-002": {
    id: "quote-002",
    items: [
      {
        id: "item-003",
        description: "Engine diagnostic",
        type: "labor",
        quantity: 1,
        unitPrice: 150,
        totalPrice: 150
      }
    ],
    subtotal: 150,
    tax: 15,
    total: 165,
    validUntil: formatDate(addDays(today, 5)),
    status: "sent",
    sentAt: formatDateTime(subDays(today, 2)),
    createdAt: formatDateTime(subDays(today, 3)),
  }
};

// Comprehensive job data covering all stages of the lifecycle
export const mockJobs: Job[] = [
  // QUOTE REQUESTS (New Quotes Tab)
  {
    id: "job-001",
    customer: "Emily Watson",
    customerEmail: "emily.watson@email.com",
    phone: "(03) 9555 1111",
    vehicle: "2020 Honda Civic",
    vehicleYear: 2020,
    vehicleMake: "Honda",
    vehicleModel: "Civic",
    service: "Brake Service",
    description: "Brakes are making a grinding noise when I stop. Sounds like it's coming from the front wheels. Started about a week ago and getting worse.",
    stage: "quote-requested",
    paymentStatus: "quote-pending",
    priority: "urgent",
    date: formatDate(today),
    notes: "Customer mentioned noise gets worse in wet conditions",
    quote: sampleQuotes["quote-001"],
    createdAt: formatDateTime(subDays(today, 1)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
  {
    id: "job-002",
    customer: "Michael Rodriguez",
    customerEmail: "m.rodriguez@email.com",
    phone: "(03) 9666 2222",
    vehicle: "2018 Toyota Camry",
    vehicleYear: 2018,
    vehicleMake: "Toyota",
    vehicleModel: "Camry",
    service: "Engine Diagnostic",
    description: "Check engine light came on yesterday. Car seems to be running fine but want to get it checked before it becomes a bigger problem.",
    stage: "quote-sent",
    paymentStatus: "quote-pending",
    priority: "normal",
    date: formatDate(addDays(today, 1)),
    quote: sampleQuotes["quote-002"],
    createdAt: formatDateTime(subDays(today, 3)),
    updatedAt: formatDateTime(subDays(today, 2)),
  },
  {
    id: "job-003",
    customer: "Sarah Chen",
    customerEmail: "sarah.chen@email.com",
    phone: "(03) 9777 3333",
    vehicle: "2019 Mazda CX-5",
    vehicleYear: 2019,
    vehicleMake: "Mazda",
    vehicleModel: "CX-5",
    service: "Air Conditioning Service",
    description: "AC not cooling properly. Takes a long time to cool down the car and doesn't seem as cold as it used to be.",
    stage: "quote-requested",
    paymentStatus: "quote-pending",
    priority: "normal",
    date: formatDate(addDays(today, 2)),
    notes: "Customer prefers morning appointments",
    createdAt: formatDateTime(subDays(today, 2)),
    updatedAt: formatDateTime(subDays(today, 2)),
  },

  // CONFIRMED BOOKINGS (Upcoming Bookings Tab)
  {
    id: "job-004",
    customer: "John Smith",
    customerEmail: "john.smith@email.com",
    phone: "(03) 9876 5432",
    vehicle: "2021 Toyota Camry",
    vehicleYear: 2021,
    vehicleMake: "Toyota",
    vehicleModel: "Camry",
    service: "Full Logbook Service",
    description: "Regular scheduled service as per logbook requirements",
    timeStart: "9:00 AM",
    timeEnd: "11:30 AM",
    duration: "2h 30min",
    stage: "confirmed",
    paymentStatus: "deposit-paid",
    bay: "Bay 2",
    estimatedCompletion: "11:30 AM",
    priority: "normal",
    date: formatDate(today),
    finalPrice: 450,
    createdAt: formatDateTime(subDays(today, 5)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
  {
    id: "job-005",
    customer: "Lisa Johnson",
    customerEmail: "lisa.j@email.com",
    phone: "(03) 9654 3210",
    vehicle: "2020 Honda Civic",
    vehicleYear: 2020,
    vehicleMake: "Honda",
    vehicleModel: "Civic",
    service: "Brake Inspection & Service",
    description: "Follow-up from quote - brake pad replacement",
    timeStart: "11:45 AM",
    timeEnd: "1:15 PM",
    duration: "1h 30min",
    stage: "confirmed",
    paymentStatus: "unpaid",
    bay: "Bay 1",
    estimatedCompletion: "1:15 PM",
    priority: "urgent",
    date: formatDate(today),
    finalPrice: 341,
    notes: "Quote accepted - brake pads and inspection",
    createdAt: formatDateTime(subDays(today, 7)),
    updatedAt: formatDateTime(subDays(today, 3)),
  },
  {
    id: "job-006",
    customer: "David Kim",
    customerEmail: "david.kim@email.com",
    phone: "(03) 9321 6547",
    vehicle: "2022 BMW X3",
    vehicleYear: 2022,
    vehicleMake: "BMW",
    vehicleModel: "X3",
    service: "Transmission Service",
    description: "Scheduled transmission fluid change and inspection",
    timeStart: "1:00 PM",
    timeEnd: "3:30 PM",
    duration: "2h 30min",
    stage: "confirmed",
    paymentStatus: "deposit-paid",
    bay: "Bay 3",
    estimatedCompletion: "3:30 PM",
    priority: "normal",
    date: formatDate(addDays(today, 1)),
    finalPrice: 580,
    createdAt: formatDateTime(subDays(today, 10)),
    updatedAt: formatDateTime(subDays(today, 2)),
  },

  // JOBS IN PROGRESS (Jobs in Progress Tab)
  {
    id: "job-007",
    customer: "Robert Taylor",
    customerEmail: "rob.taylor@email.com",
    phone: "(03) 9333 4444",
    vehicle: "2019 Ford Focus",
    vehicleYear: 2019,
    vehicleMake: "Ford",
    vehicleModel: "Focus",
    service: "Tire Rotation & Balance",
    description: "Regular tire maintenance and wheel balancing",
    timeStart: "2:00 PM",
    timeEnd: "3:00 PM",
    duration: "1h",
    stage: "in-progress",
    paymentStatus: "paid-full",
    bay: "Bay 3",
    estimatedCompletion: "3:00 PM",
    priority: "normal",
    date: formatDate(today),
    actualStartTime: "2:05 PM",
    finalPrice: 120,
    notes: "Started 5 minutes late due to previous job overrun",
    createdAt: formatDateTime(subDays(today, 5)),
    updatedAt: formatDateTime(today),
  },
  {
    id: "job-008",
    customer: "Angela Foster",
    customerEmail: "angela.foster@email.com",
    phone: "(03) 9444 5555",
    vehicle: "2020 Nissan Navara",
    vehicleYear: 2020,
    vehicleMake: "Nissan",
    vehicleModel: "Navara",
    service: "Engine Oil & Filter Change",
    description: "Regular oil change service",
    timeStart: "8:30 AM",
    timeEnd: "9:30 AM",
    duration: "1h",
    stage: "in-progress",
    paymentStatus: "paid-full",
    bay: "Bay 1",
    estimatedCompletion: "9:30 AM",
    priority: "normal",
    date: formatDate(today),
    actualStartTime: "8:30 AM",
    finalPrice: 120,
    createdAt: formatDateTime(subDays(today, 3)),
    updatedAt: formatDateTime(today),
  },

  // COMPLETED JOBS (Completed Jobs Tab)
  {
    id: "job-009",
    customer: "Jennifer Martinez",
    customerEmail: "jenny.martinez@email.com",
    phone: "(03) 9789 1234",
    vehicle: "2018 Mazda CX-5",
    vehicleYear: 2018,
    vehicleMake: "Mazda",
    vehicleModel: "CX-5",
    service: "Basic Service",
    description: "Standard service and safety check",
    timeStart: "3:30 PM",
    timeEnd: "4:30 PM",
    duration: "1h",
    stage: "completed",
    paymentStatus: "paid-full",
    bay: "Bay 1",
    estimatedCompletion: "4:30 PM",
    priority: "normal",
    date: formatDate(subDays(today, 1)),
    actualStartTime: "3:30 PM",
    actualEndTime: "4:25 PM",
    finalPrice: 180,
    createdAt: formatDateTime(subDays(today, 8)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
  {
    id: "job-010",
    customer: "Peter Williams",
    customerEmail: "peter.w@email.com",
    phone: "(03) 9666 7777",
    vehicle: "2018 Ford Ranger",
    vehicleYear: 2018,
    vehicleMake: "Ford",
    vehicleModel: "Ranger",
    service: "Suspension Repair",
    description: "Replace worn shock absorbers and struts",
    timeStart: "10:00 AM",
    timeEnd: "2:00 PM",
    duration: "4h",
    stage: "completed",
    paymentStatus: "paid-full",
    bay: "Bay 2",
    estimatedCompletion: "2:00 PM",
    priority: "normal",
    date: formatDate(subDays(today, 2)),
    actualStartTime: "10:00 AM",
    actualEndTime: "1:45 PM",
    finalPrice: 680,
    notes: "Completed 15 minutes early",
    createdAt: formatDateTime(subDays(today, 15)),
    updatedAt: formatDateTime(subDays(today, 2)),
  },
  {
    id: "job-011",
    customer: "Sophie Martin",
    customerEmail: "sophie.m@email.com",
    phone: "(03) 9888 9999",
    vehicle: "2017 Volkswagen Golf",
    vehicleYear: 2017,
    vehicleMake: "Volkswagen",
    vehicleModel: "Golf",
    service: "Battery Replacement",
    description: "Replace failing battery and test charging system",
    timeStart: "11:00 AM",
    timeEnd: "12:00 PM",
    duration: "1h",
    stage: "completed",
    paymentStatus: "paid-full",
    bay: "Bay 3",
    estimatedCompletion: "12:00 PM",
    priority: "urgent",
    date: formatDate(subDays(today, 3)),
    actualStartTime: "11:00 AM",
    actualEndTime: "11:45 PM",
    finalPrice: 250,
    createdAt: formatDateTime(subDays(today, 10)),
    updatedAt: formatDateTime(subDays(today, 3)),
  },

  // FUTURE BOOKINGS
  {
    id: "job-012",
    customer: "James Anderson",
    customerEmail: "james.anderson@email.com",
    phone: "(03) 9000 1111",
    vehicle: "2019 Audi A4",
    vehicleYear: 2019,
    vehicleMake: "Audi",
    vehicleModel: "A4",
    service: "Pre-Purchase Inspection",
    description: "Comprehensive inspection for potential vehicle purchase",
    timeStart: "1:00 PM",
    timeEnd: "2:30 PM",
    duration: "1h 30min",
    stage: "confirmed",
    paymentStatus: "unpaid",
    bay: "Bay 1",
    estimatedCompletion: "2:30 PM",
    priority: "normal",
    date: formatDate(addDays(today, 7)),
    finalPrice: 300,
    notes: "Customer bringing vehicle from dealership",
    createdAt: formatDateTime(subDays(today, 5)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },

  // ADDITIONAL TEST DATA FOR VARIOUS DATES
  {
    id: "job-013",
    customer: "Rachel Green",
    customerEmail: "rachel.green@email.com",
    phone: "(03) 9123 4567",
    vehicle: "2021 Tesla Model 3",
    vehicleYear: 2021,
    vehicleMake: "Tesla",
    vehicleModel: "Model 3",
    service: "Annual Service",
    description: "Yearly maintenance check for electric vehicle",
    timeStart: "10:00 AM",
    timeEnd: "12:00 PM",
    duration: "2h",
    stage: "confirmed",
    paymentStatus: "deposit-paid",
    bay: "Bay 2",
    estimatedCompletion: "12:00 PM",
    priority: "normal",
    date: formatDate(addDays(today, 3)),
    finalPrice: 400,
    createdAt: formatDateTime(subDays(today, 10)),
    updatedAt: formatDateTime(subDays(today, 3)),
  },
  {
    id: "job-014",
    customer: "Mark Thompson",
    customerEmail: "mark.t@email.com",
    phone: "(03) 9987 6543",
    vehicle: "2019 Ford Transit",
    vehicleYear: 2019,
    vehicleMake: "Ford",
    vehicleModel: "Transit",
    service: "Commercial Vehicle Service",
    description: "Full commercial vehicle inspection and service",
    stage: "quote-requested",
    paymentStatus: "quote-pending",
    priority: "urgent",
    date: formatDate(addDays(today, 1)),
    notes: "Customer needs van back by end of week",
    createdAt: formatDateTime(subDays(today, 1)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
  {
    id: "job-015",
    customer: "Diana Prince",
    customerEmail: "diana.prince@email.com",
    phone: "(03) 9555 7777",
    vehicle: "2020 Mercedes C-Class",
    vehicleYear: 2020,
    vehicleMake: "Mercedes",
    vehicleModel: "C-Class",
    service: "Luxury Car Service",
    description: "Premium service package for luxury vehicle",
    timeStart: "2:00 PM",
    timeEnd: "5:00 PM",
    duration: "3h",
    stage: "confirmed",
    paymentStatus: "paid-full",
    bay: "Bay 3",
    estimatedCompletion: "5:00 PM",
    priority: "normal",
    date: formatDate(addDays(today, 5)),
    finalPrice: 750,
    notes: "VIP customer - premium service required",
    createdAt: formatDateTime(subDays(today, 12)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
  {
    id: "job-016",
    customer: "Tony Stark",
    customerEmail: "tony.stark@email.com",
    phone: "(03) 9888 1234",
    vehicle: "2022 Lamborghini Huracan",
    vehicleYear: 2022,
    vehicleMake: "Lamborghini",
    vehicleModel: "Huracan",
    service: "Supercar Maintenance",
    description: "Specialized maintenance for high-performance vehicle",
    stage: "quote-sent",
    paymentStatus: "quote-pending",
    priority: "normal",
    date: formatDate(addDays(today, 2)),
    notes: "Requires specialist technician",
    createdAt: formatDateTime(subDays(today, 3)),
    updatedAt: formatDateTime(subDays(today, 1)),
  },
];

// Enhanced status configuration with comprehensive job lifecycle
export const statusConfig: StatusConfig = {
  jobStage: {
    "quote-requested": { 
      label: "Quote Requested", 
      className: "bg-amber-100 text-amber-800",
      color: "#f59e0b"
    },
    "quote-sent": { 
      label: "Quote Sent", 
      className: "bg-blue-100 text-blue-800",
      color: "#3b82f6"
    },
    confirmed: { 
      label: "Confirmed", 
      className: "bg-green-100 text-green-800",
      color: "#10b981"
    },
    "in-progress": { 
      label: "In Progress", 
      className: "bg-purple-100 text-purple-800",
      color: "#8b5cf6"
    },
    completed: { 
      label: "Completed", 
      className: "bg-emerald-100 text-emerald-800",
      color: "#059669"
    },
    cancelled: { 
      label: "Cancelled", 
      className: "bg-red-100 text-red-800",
      color: "#ef4444"
    },
  },
  paymentStatus: {
    "quote-pending": { label: "Quote Pending", className: "bg-amber-100 text-amber-800" },
    "deposit-paid": { label: "Deposit Paid", className: "bg-blue-100 text-blue-800" },
    "paid-full": { label: "Paid in Full", className: "bg-green-100 text-green-800" },
    unpaid: { label: "Unpaid", className: "bg-red-100 text-red-800" },
  },
  priority: {
    normal: { label: "Normal", className: "bg-slate-100 text-slate-800" },
    urgent: { label: "Urgent", className: "bg-orange-100 text-orange-800" },
  },
};

// Helper functions for job management
export const getJobsByStage = (stage: string) => {
  return mockJobs.filter(job => job.stage === stage);
};

export const getTodaysJobs = () => {
  return mockJobs.filter(job => job.date === formatDate(today));
};

export const getJobsRequiringAction = () => {
  return mockJobs.filter(job => 
    job.stage === 'quote-requested' || 
    (job.stage === 'confirmed' && job.date === formatDate(today))
  );
};